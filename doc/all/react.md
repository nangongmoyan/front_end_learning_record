# React 面试题

### 1.React 中的 setState 缺点是什么呢

setState 执行的时候可以简单的理解为：隶属于原生 js 执行的空间，那么就是属于同步；被 react 处理过的空间属于异步，这其实也是一种性能优化，如果多次使用 setState 修改值，那么在异步中会先进行合并，再进行渲染，降低了操作 dom 的次数；具体如下：

- setState 在合成时间和钩子函数中是“异步”的，在原生事件和 setTimeout 中是同步的
- setState 的“异步”并不是说内部代码由异步代码实现，其实本身执行的过程和代码都是同步的，只是合成事件和钩子函数的调用顺序在更新之前，导致在合成事件和钩子函数中无法立即拿到更新后的值，形成了所谓的“异步”，当然可以通过第二个参数 setState（partialState，callback）中的 callback 拿到更新后的结果
- setState 的批量更新优化也是建立在“异步”（合成事件、钩子函数）之上的，在原生事件和 setTimeout 中不会批量更新，在“异步”中如果对同一个值进行多次 setState，setState 的批量更新策略会对其进行覆盖，取最后一次的执行，如果同时 setState 多个不同的值，在更新时会对其进行合并批量更新
- 正是由于 setState 存在异步的机制，如果 setState 修改值的时候依赖于 state 本身的值，有时候并不可靠，这时候我们需要传入一个回调函数作为入参，这个回调函数的第一个参数为更新前的 state 值

### 2.虚拟 DOM 的优劣如何?实现原理?

虚拟 dom 是用 js 模拟一颗 dom 树，放在浏览器内存中，相当于在 js 和真实 dom 中加了一个缓存，利用 dom diff 算法避免了没有必要的 dom 操作，从而提高性能

##### 优点：

- 虚拟 DOM 具有批处理和高效的 Diff 算法，最终表现在 DOM 上的修改只是变更的部分，可以保证非常高效的渲染和性能优化
- 虚拟 DOM 不会立马进行排版和重绘操作，对虚拟 DOM 进行频繁修改，最后一次性比较并修改真实 DOM 中需要修改的部分
- 虚拟 DOM 有效降低大面积真实 DOM 的重绘与排版，因为最终与真实 DOM 比较差异，可以只渲染局部

##### 缺点：

- 首次渲染大量 DOM 时，由于多了一层虚拟 DOM 的计算，会比 innerHTML 插入慢

### 3.纯函数有什么特点，副作用函数特点

纯函数与外界交换数据只有一个唯一渠道：参数和返回值；函数从函数外部接受的所有输入信息都通过参数传递到该函数内部；函数输出到函数外部的所有信息都通过返回值传递到该函数外部。

##### 纯函数的优点：

无状态，线程安全；纯函数相互调用组装起来的函数还是纯函数；应用程序或者运行环境可以对纯函数的运算结果进行缓存，运算加快速度。

##### 函数副作用

指当调用函数时，除了返回函数值之外，还对主调用函数产生附加的影响。比如调接口、修改全局变量、抛出一个异常或以一个错误终止，打印到终端或读取用户输入、读取或写入一个文件等，所以说副作用时编程中最关键的部分，因为我们需要跟用户、跟数据进行交互
